##*********************************????????***********************************##

setwd("C:\\")

##?????? ????(????????)
install.packages("Hmisc")
install.packages("ggm")
install.packages("ggplot2")
install.packages("polycor")

##?????? ????
library(boot)
library(ggm)
library(ggplot2)
library(Hmisc)
library(polycor)

## ???????? (?? ?????? ???????? ??, ?? ???? ?? ?????? ????)
adverts<-c(5,4,4,6,8)
packets<-c(8,9,10,13,15)
advertData<-data.frame(adverts, packets)
# u???? ?????? ???? 5??, ???? 8????

cov(advertData)
# ?????? ?????? ???? ????
# 4.25(adverts x packets)?? ?? ???? ??????

var(adverts)
# adverts?? ?????? ???? ???? 2.8?? ????


## ???? ???????? ???????? ???? ????

adverts<-c(5,4,4,6,8)
packetsNA<-c(8,9,10,NA,15)
# ???????? ?????? N/A?? ??????

age<-c(5, 12, 16, 9, 14)

advertNA<-data.frame(adverts, packetsNA, age)

cor(advertData)

cor(advertNA, use = "everything",  method = "pearson")
# cor(x, y, use= "?????? o?? ????", method = "???????? ????")
# x?? ???? ???? ???? ?????? ?????? / y?? ???? ???? ???? (x?? ???????????????? y?? ?????? ?????? ????)
# cor?????? ???????? pearson???????? / ???? ????(e.g. spearman)?? ?????? ???? ?????????? ??
# use="everything" ?????? ?????? ???????? ?????? ???????? ???? ??u?? ???? ???? ?????? NA?? ??????


## ?????? ????????(???????? ????????)

# cor(x,y, use = "everything", method = "pearson")
# use="" ???????? ?????? o??????(4????)?? ??????.
# "everything"(default)?? ???????? ?????? NA?? ???? / all.obs=???? ???????? ???????? ??, ?????? ?????? ????
# complete.obs= ???????? ???? ?????? ???? ???? / pairwise.compete.obs= ?????????? ???????? ?????? ?????? ?????? ???? ????????(N/A??) ????

examData = read.delim("Exam Anxiety.dat",  header = TRUE)
examData

cor(examData$Exam, examData$Anxiety, use = "complete.obs", method = 'pearson')
# exam?? anxiety?? ?????????? ?????? ????

examData2 <- examData[, c("Exam", "Anxiety", "Revise")]
# ???????? ???????? (????o?? ????)

cor(examData2)

cor(examData[, c("Exam", "Anxiety", "Revise")])
# ???? ?????? ???? ???????? ????


# ???????? ?????? ????
cor.test(examData$Exam, examData$Anxiety, use = "complete.obs", method = 'pearson')
# ???????? r ?? -0.44?? ??????, t???????????? -4.938?? ?????????????? ???????? t(0.025,101)=-0.584???? ?? ???? ?????? 95% ???????????? ?????? ??????
# -0.4409934*sqrt(101/(1-(0.4409934^2)) = -4.938


## ???????? ????????-?????? o???? ????o???? ????

liarData = read.delim("The Biggest Liar.dat",  header = TRUE)
liarData

cor(liarData$Position, liarData$Creativity, method = "spearman")
# method?? spearman???? ???????? ?????????? ??????
# ?????????? ???? ?????????? ???? ?????? ??????

cor.test(liarData$Position, liarData$Creativity, method = "spearman") 
# ???????? ?????????? ???? ?????????? ??????????
# p-value?? ???? ?????? ???????? ???? ??u?? ???????? rho??(????????)?? -0.37?? ??????
# ?????? ?????????? ?? ?????????? ?????? ???????? ?????? a?o?

cor.test(liarData$Position, liarData$Creativity, alternative = "less", method = "spearman")  
cor.test(liarData$Position, liarData$Creativity, alternative = "greater", method = "spearman") 
# ???? ?????????? ?????? alternative="less"???? ????????, ?????? ?????????? ?????? alternative = "greater"???? ???????? ??????

# ???????? ????????
liarMatrix<-as.matrix(liarData[, c("Position", "Creativity")])
rcorr(liarMatrix)
# ?????????????? ?????? ?????? ?? rcorr() ???? ????


#****************???????? ???????? - ???? ?? ?????? ???? ?????????? ?????????? ????**************

cor(liarData$Position, liarData$Creativity, method = "kendall")
cor.test(liarData$Position, liarData$Creativity, alternative = "less", method = "kendall")

cor(advertData$adverts, advertData$packets, method = "kendall")
cor.test(advertData$adverts, advertData$packets, alternative = "greater", method = "kendall")


#***************?????????? - ??3 ?????? ???????? ???????? ???? ??***************

examData = read.delim("Exam Anxiety.dat",  header = TRUE)
maleExam<-subset(examData, Gender == "Male", select= c("Exam", "Anxiety"))
femaleExam<-subset(examData, Gender == "Female", select= c("Exam", "Anxiety"))
cor(maleExam)
cor(femaleExam)

examData2 <- examData[, c("Exam", "Anxiety", "Revise")]
library(ggm)
pc<-pcor(c("Exam", "Anxiety", "Revise"), var(examData2)) 
# ?????????? pcor() / ?????????? ?????? ???? pcor.test()
# pcor(c(var1, var2, contro1, control2), var(dataframe))


# ?????????? ????????

pc
# ?????????? ????

pc^2
# ?????????? ?????? ???? ?? ?????? ???????? ??

pcor.test(pc, 1, 103) 
# pcor.test(pcor?? ???? ??u, ???? ?????? ????, ???? ????)
# 'Revise'???? z?????? ?????????? exam?? anxiety?? ?????? ?????????? ?????? ?????????? ???? ?????? ?? ????